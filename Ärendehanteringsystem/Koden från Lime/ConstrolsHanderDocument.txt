Option Explicit
    
    Private WithEvents m_Controls As Lime.Controls
    Private WithEvents m_Inspector As Lime.Inspector

Private Sub Class_Initialize()
    On Error GoTo ErrorHandler
    Set m_Controls = Application.ActiveControls
    
    If Not m_Controls Is Nothing Then
        If m_Controls.Parent Is m_Controls.ParentInspector Then
            Set m_Inspector = m_Controls.ParentInspector
        End If
        Call Setup
    End If
    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerDocument.Class_Initialize")
End Sub

Private Sub m_controls_AfterRecordChanged()
    On Error GoTo ErrorHandler
    Call Setup
    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerDocument.m_controls_AfterRecordChanged")
End Sub

Private Sub m_Controls_Refresh()
    On Error GoTo ErrorHandler
    Call Setup
    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerDocument.m_Controls_Refresh")
End Sub

Private Sub Setup()
    On Error GoTo ErrorHandler
    If Not m_Controls Is Nothing Then
        
        ' When new
        'FDA Flyttat till generall hantering av relationer
'        If (m_controls.State And lkControlsStateNew) = lkControlsStateNew Then
'            If m_controls.GetValue("person", 0) > 0 Then
'                    Call m_controls.SetValue("company", m_controls.GetValue("person.company"))
'            End If
'        End If
    End If

    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerDocument.Setup")
End Sub


