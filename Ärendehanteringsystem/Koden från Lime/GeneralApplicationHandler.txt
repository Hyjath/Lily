Option Explicit

    Private WithEvents m_Application As Lime.Application
    Private WithEvents m_Explorers As Lime.Explorers
    Private WithEvents m_Explorer As Lime.Explorer
    Private m_GeneralExplorerHandler As GeneralExplorerHandler
   
Private Sub Class_Initialize()
    On Error GoTo ErrorHandler
    Set m_Application = Application
    If Not m_Application Is Nothing Then
        If Not m_Application.Explorers Is Nothing Then
            Set m_Explorers = Application.Explorers
            If Not m_Explorers.ActiveExplorer Is Nothing Then
                Set m_Explorer = m_Explorers.ActiveExplorer
                
                'Kör direkt
                Call m_Explorers_AfterActiveExplorerChanged
            End If
        End If
    End If
    Exit Sub
ErrorHandler:
    Call UI.ShowError("GeneralApplicationHandler.Class_Initialize")
End Sub

Private Sub m_Explorers_AfterActiveExplorerChanged()
    On Error GoTo ErrorHandler
    If Not Application.ActiveExplorer Is Nothing Then
        Set m_Explorers = Application.Explorers
        Set m_Explorer = m_Explorers.ActiveExplorer
        Set m_GeneralExplorerHandler = New GeneralExplorerHandler
    End If
    
    'PATTERN: AUTOREFRESH
    'END AUTOREFRESH---------------------------------------------------------------------------------------------------------

    Exit Sub
ErrorHandler:
    Call UI.ShowError("GeneralApplicationHandler.m_Explorers_AfterActiveExplorerChanged")
End Sub

'PATTERN: AUTOREFRESH
'END AUTOREFRESH---------------------------------------------------------------------------------------------------------
