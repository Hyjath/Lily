Option Explicit
    
'This template includes controls event only. Controls events should always be used instead of inspector
'events if both hold the same event. Control events are used when editing lists.



    Private WithEvents m_Controls As Lime.Controls
    
Private Sub Class_Initialize()
    On Error GoTo ErrorHandler
    Set m_Controls = Application.ActiveControls
    
    If Not m_Controls Is Nothing Then
        Call Setup
    End If
    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerTemplate.Class_Initialize")
End Sub

Private Sub m_controls_AfterRecordChanged()
    On Error GoTo ErrorHandler
    Call Setup
    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerTemplate.m_controls_AfterRecordChanged")
End Sub

Private Sub m_Controls_Refresh()
    On Error GoTo ErrorHandler
    Call Setup
    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerTemplate.m_Controls_Refresh")
End Sub

Private Sub Setup()
'Setup may only be called from Class_Initialize and the CONTROL events
    On Error GoTo ErrorHandler
    If Not m_Controls.Record Is Nothing Then
        ' When new
        If (m_Controls.State And lkControlsStateNew) = lkControlsStateNew Then
            ' Add code here
        End If
    End If

    Exit Sub
ErrorHandler:
    Call UI.ShowError("ControlsHandlerTemplate.Setup")
End Sub

