Option Explicit

Private Sub Report360Report(ByVal Report As LDE.IReport)
    On Error GoTo ErrorHandler
    Dim oDialog As Form360Report
    Dim oPool As LDE.Pool
    
    ' make sure the report can be printer (user must be in the company tab)
    If Application.ActiveExplorer Is Nothing Then
        Call Application.MessageBox("Rapporten måste köras från Kund-fliken.")
    ElseIf Not VBA.LCase(Application.ActiveExplorer.Class.Name) = "company" Then
        Call Application.MessageBox("Rapporten måste köras från Kund-fliken.")
    ElseIf Application.ActiveExplorer.Selection Is Nothing Then
        Call Application.MessageBox("Det finns inga kunder markerade.")
    ElseIf Application.ActiveExplorer.Selection.Count = 0 Then
        Call Application.MessageBox("Det finns inga kunder markerade.")
    Else
        ' create a pool from selected companies
        Set oPool = New LDE.Pool
        Set oPool = Application.ActiveExplorer.Selection.Pool
        
        
        Set oDialog = New Form360Report
        If oDialog.InitializeForm(Report, oPool) Then
            Call oDialog.show(vbModal)
        End If
        Set oDialog = Nothing
    End If
    
    Exit Sub
ErrorHandler:
    Call UI.ShowError("SystemReportManager.ReportKontaktReport")
End Sub

Public Sub RunReport(ByVal sName As String)
    On Error GoTo ErrorHandler
    
    Dim oReport As LDE.IReport
    
    Set oReport = Application.Database.Reports.Lookup(sName, lkLookupReportByName)
    
    If oReport Is Nothing Then
        Call Err.Raise(UI.cErrorShowMessageBox, , Application.FormatString("Systemrapporten '%1' finns inte. Kontrollera att den inte har döpts om.", sName))
    End If
    
    Select Case oReport.Name
        Case "360 rapport":
            Call Report360Report(oReport)
    End Select
    
    Exit Sub
ErrorHandler:
    Call UI.ShowError("SystemReportManager.RunReport")
End Sub

